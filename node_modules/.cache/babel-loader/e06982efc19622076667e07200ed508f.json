{"ast":null,"code":"import _slicedToArray from\"/Users/maryna/Desktop/projects/test-app/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import FeedbackFooter from\"./FeedbackFooter\";import FeedbackForm from\"./FeedbackForm\";import{useSelector,useDispatch}from\"react-redux\";import{formActions}from\"../../store/form\";import Modal from\"../UI/Modal\";import{Circle,Clouds,Goodie1,MainSection,Map,Smile1,Smile2}from\"./Feedback.styled\";import useFetchData from\"../../hooks/useFetchData\";import{jsx as _jsx}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var Feedback=function Feedback(){var dispatch=useDispatch();var data=useSelector(function(state){return{name:state.form.name.value,email:state.form.email.value,message:state.form.message.value};});var showModal=useSelector(function(state){return state.form.showModal;});var modalMessage=useSelector(function(state){return state.form.modalMessage;});var _useFetchData=useFetchData(),_useFetchData2=_slicedToArray(_useFetchData,3),error=_useFetchData2[0],skipError=_useFetchData2[1],requestFunction=_useFetchData2[2];var handleClose=function handleClose(){dispatch(formActions.closeModal());};var dataProcess=function dataProcess(data){var modalMessage=\"Storage failed!\";if(data.id){modalMessage=\"Successfully stored to DB. Record ID: \".concat(data.id);}if(data.error){modalMessage=\"\".concat(data.error,\": \").concat(data.message);}dispatch(formActions.setModalMessage(modalMessage));dispatch(formActions.showModal());};var storeMessage=function storeMessage(){dispatch(formActions.setModalMessage(\"\"));requestFunction({url:\"http://localhost:3001/messages\",method:\"POST\",body:JSON.stringify(data),headers:{\"Content-Type\":\"application/json\"}},dataProcess);};if(error){dispatch(formActions.setModalMessage(error));dispatch(formActions.showModal());skipError();}var ModalContent=showModal?/*#__PURE__*/_jsx(Modal,{onClick:handleClose,children:/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"p\",{children:modalMessage}),/*#__PURE__*/_jsx(\"p\",{children:\"Click on the screen to close this message\"})]})}):\"\";return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(MainSection,{children:[/*#__PURE__*/_jsx(Smile1,{}),/*#__PURE__*/_jsx(Smile2,{}),/*#__PURE__*/_jsx(Clouds,{}),/*#__PURE__*/_jsx(Goodie1,{}),/*#__PURE__*/_jsx(Map,{}),/*#__PURE__*/_jsx(Circle,{}),/*#__PURE__*/_jsx(FeedbackForm,{storeMessage:storeMessage}),/*#__PURE__*/_jsx(FeedbackFooter,{})]}),ModalContent]});};export default Feedback;","map":{"version":3,"names":["FeedbackFooter","FeedbackForm","useSelector","useDispatch","formActions","Modal","Circle","Clouds","Goodie1","MainSection","Map","Smile1","Smile2","useFetchData","Feedback","dispatch","data","state","name","form","value","email","message","showModal","modalMessage","error","skipError","requestFunction","handleClose","closeModal","dataProcess","id","setModalMessage","storeMessage","url","method","body","JSON","stringify","headers","ModalContent"],"sources":["/Users/maryna/Desktop/projects/test-app/src/componemnts/Feedback/Feedback.js"],"sourcesContent":["import FeedbackFooter from \"./FeedbackFooter\";\nimport FeedbackForm from \"./FeedbackForm\";\nimport { useSelector, useDispatch } from \"react-redux\";\nimport { formActions } from \"../../store/form\";\nimport Modal from \"../UI/Modal\";\nimport {\n  Circle,\n  Clouds,\n  Goodie1,\n  MainSection,\n  Map,\n  Smile1,\n  Smile2,\n} from \"./Feedback.styled\";\nimport useFetchData from \"../../hooks/useFetchData\";\n\nconst Feedback = () => {\n  const dispatch = useDispatch();\n  const data = useSelector((state) => {\n    return {\n      name: state.form.name.value,\n      email: state.form.email.value,\n      message: state.form.message.value,\n    };\n  });\n  const showModal = useSelector((state) => state.form.showModal);\n  const modalMessage = useSelector((state) => state.form.modalMessage);\n  const [error, skipError, requestFunction] = useFetchData();\n  const handleClose = () => {\n    dispatch(formActions.closeModal());\n  };\n\n  const dataProcess = (data) => {\n    let modalMessage = \"Storage failed!\";\n    if (data.id) {\n      modalMessage = `Successfully stored to DB. Record ID: ${data.id}`;\n    }\n    if (data.error) {\n      modalMessage = `${data.error}: ${data.message}`;\n    }\n    dispatch(formActions.setModalMessage(modalMessage));\n    dispatch(formActions.showModal());\n  };\n  const storeMessage = () => {\n    dispatch(formActions.setModalMessage(\"\"));\n    requestFunction(\n      {\n        url: \"http://localhost:3001/messages\",\n        method: \"POST\",\n        body: JSON.stringify(data),\n        headers: { \"Content-Type\": \"application/json\" },\n      },\n      dataProcess\n    );\n  };\n  if (error) {\n    dispatch(formActions.setModalMessage(error));\n    dispatch(formActions.showModal());\n    skipError();\n  }\n  const ModalContent = showModal ? (\n    <Modal onClick={handleClose}>\n      <>\n        <p>{modalMessage}</p>\n        <p>Click on the screen to close this message</p>\n      </>\n    </Modal>\n  ) : (\n    \"\"\n  );\n  return (\n    <>\n      <MainSection>\n        <Smile1 />\n        <Smile2 />\n        <Clouds />\n        <Goodie1 />\n        <Map />\n        <Circle />\n        <FeedbackForm storeMessage={storeMessage} />\n        <FeedbackFooter />\n      </MainSection>\n      {ModalContent}\n    </>\n  );\n};\n\nexport default Feedback;\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}